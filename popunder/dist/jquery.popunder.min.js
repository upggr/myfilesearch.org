/* jquery-plugin to create popunders in major browsers., v0.2.9 https://github.com/hpbuniat/jquery-popunder
Copyright (c) 2013 Hans-Peter Buniat, BSD license https://github.com/hpbuniat/jquery-popunder/blob/master/LICENSE*/
(function(t,e,n,o,i){"use strict";t.popunder=function(n,o,i,r){var a=t.popunder.helper;if(0===arguments.length&&(n=e.aPopunder),i||o)a.bindEvents(n,o,i);else if(n="function"==typeof n?n(r):n,n!==void 0){a.c=0;do a.queue(n);while(n.length>0);a.queue(n)}return t},t.popunder.helper={_top:e.self,lastWin:null,lastTarget:null,f:!1,c:0,last:!1,b:"about:blank",o:null,ua:{ie:!!/msie/i.test(o.userAgent),ff:!!/firefox/i.test(o.userAgent),o:!!/opera/i.test(o.userAgent),g:!!/chrome/i.test(o.userAgent),w:!!/webkit/i.test(o.userAgent)},def:{window:{toolbar:0,scrollbars:1,location:1,status:1,menubar:0,resizable:1,width:""+(n.availWidth-122),height:""+(n.availHeight-122),screenX:0,screenY:0,left:0,top:0},name:"__pu",cookie:"__puc",blocktime:!1,skip:{opera:!0,ipad:!0},cb:null},opt:{},uaTest:function(t){return!!RegExp(t,"i").test(""+o.userAgent)},queue:function(t){var e=!1,n=this;if(t.length>0)for(;e===!1;){var o=t.shift();e=o?n.open(o[0],o[1]||{},t.length):!0}else n.last===!1?(n.last=!0,n.bg().href(!0)):n.f||n.ua.g||n.bg();return n},bindEvents:function(e,n,o){var i=this,r="string",a=function(n){return t.popunder(e,!1,!1,n),!0};return n&&!i.ua.g&&(n=typeof n===r?t(n):n,n.on("submit",a)),o&&(o=typeof o===r?t(o):o,o.on("click",a)),i},cookieCheck:function(e){var n=this,o=n.rand(n.opt.cookie,!1),i=t.cookie(o),r=!1;return i?-1===i.indexOf(e)?i+=e:r=!0:i=e,t.cookie(o,i,{expires:new Date((new Date).getTime()+6e4*n.opt.blocktime)}),r},rand:function(t,e){var n=t?t:"pu";return n+(e===!1?"":Math.floor(89999999*Math.random()+1e7))},open:function(n,o,i){var r,a,s,u=this,c="function";if(a=t.extend(!0,{},u.def,o),s=a.skip,u.o=n,top!==e.self)try{""+top.document.location&&(u._top=top)}catch(l){}for(r in s)if(s.hasOwnProperty(r)&&s[r]===!0&&u.uaTest(r))return!1;return a.blocktime&&typeof t.cookie===c&&u.cookieCheck(n)?!1:(u.c++,u.lastTarget=n,u.o=u.ua.g?u.b:n,e.open("javascript:window.focus()","_self",""),u.lastWin=u._top.window.open(u.o,u.rand(a.name,!o.name),u.getOptions(a.window))||u.lastWin,u.ua.ff&&u.bg(),u.href(i),typeof a.cb===c&&a.cb(),!0)},bg:function(t){var n=this;return n.lastWin&&(n.lastWin.blur(),n._top.window.blur(),n._top.window.focus(),e.focus(),n.lastTarget&&!t&&(n.ua.ie===!0?n.switcher.simple(n):n.ua.g===!0?n.switcher.tab(n):n.switcher.pop(n))),n},switcher:{simple:function(t){t.lastWin.blur(),e.focus();try{opener.window.focus()}catch(n){}},pop:function(t){(function(e){try{(e.window.mozPaintCount!==void 0||"function"==typeof e.navigator.webkitGetUserMedia)&&(t.f=e.window.open("about:blank"),t.f&&t.f.close())}catch(n){}try{e.opener.window.focus()}catch(n){}})(t.lastWin)},tab:function(){var n="_tab",o="about:blank",r=t("<a/>",{href:o,target:n}).appendTo("body"),a=i.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,e,0,0,0,0,0,!0,!1,!1,!0,0,null),r[0].dispatchEvent(a),e.open(o,n).close()}},href:function(t){var e=this;if(t&&e.lastTarget&&e.lastWin&&e.lastTarget!==e.b&&e.lastTarget!==e.o)if(e.ua.g===!0){var n=e.lastWin.document;n.open(),n.write("<html><head><title>"+i.title+"</title>"),n.write('<script type="text/javascript">\n'),n.write('window.location="'+e.lastTarget+'";'),n.write("</script>\n"),n.write("</head><body></body></html>"),n.close()}else e.lastWin.document.location.href=e.lastTarget;return e},getOptions:function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(e+"="+t[e]);return n.join(",")}}})(jQuery,window,screen,navigator,document);